using System.Net;
using System.Net.Mail;
using System.Web.Services;

namespace VTNORTON.Services
{
    /// <summary>
    /// Summary description for Feedback
    /// </summary>
    [WebService(Namespace = "http://tempuri.org/")]
    [WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
    [System.ComponentModel.ToolboxItem(false)]
    // To allow this Web Service to be called from script, using ASP.NET AJAX, uncomment the following line. 
    // [System.Web.Script.Services.ScriptService]
    public class Feedback : WebService
    {
        private static string Start = @"<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Strict//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd'><html xmlns='http://www.w3.org/1999/xhtml'><head> <meta http-equiv='Content-Type' content='text/html; charset=utf-8'> <meta name='viewport' content='width=device-width, initial-scale=1.0'> <title>3466a9c989e518c</title> <style type='text/css'> /* Based on The MailChimp Reset INLINE: Yes. */ /* Client-specific Styles */ #outlook a{padding: 0;}/* Force Outlook to provide a 'view in browser' menu link. */ body{height: 100%; width: 100% !important; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; margin: 0; padding: 0;}html{height: 100%;}/* Prevent Webkit and Windows Mobile platforms from changing default font sizes.*/ .ExternalClass{width: 100%;}/* Force Hotmail to display emails at full width */ .ExternalClass, .ExternalClass p, .ExternalClass span, .ExternalClass font, .ExternalClass td, .ExternalClass div{line-height: 100%;}/* Forces Hotmail to display normal line spacing. More on that: http://www.emailonacid.com/forum/viewthread/43/ */ #backgroundTable{height: 100%; margin: 0; padding: 0; width: 100% !important; line-height: 100% !important;}/* End reset */ /* Some sensible defaults for imagesBring inline: Yes. */ img{outline: none; text-decoration: none; -ms-interpolation-mode: bicubic;}a img{border: none;}.image_fix{display: block;}/* Yahoo paragraph fixBring inline: Yes. */ p{margin: 1em 0;}/* Hotmail header color resetBring inline: Yes. */ h1, h2, h3, h4, h5, h6{color: black !important;}/*h1 a, h2 a, h3 a, h4 a, h5 a, h6 a{color: blue !important;}*/ /*h1, .h1{color:#202020;display:block; font-family:Arial; font-size:34px; font-weight:bold; line-height:100%;margin-top:0;margin-right:0;margin-bottom:10px;margin-left:0;text-align:left;}h2, .h2{color:#202020;display:block;font-family:Arial;font-size:30px;font-weight:bold;line-height:100%;margin-top:0;margin-right:0;margin-bottom:10px;margin-left:0;text-align:left;}h3, .h3{color:#202020;display:block;font-family:Arial;font-size:26px;font-weight:bold;line-height:100%;margin-top:0;margin-right:0;margin-bottom:10px;margin-left:0;text-align:left;}h4, .h4{color:#202020;display:block;font-family:Arial;font-size:22px;font-weight:bold;line-height:100%;margin-top:0;margin-right:0;margin-bottom:10px;margin-left:0;text-align:left;}h5, .h5{color:#202020; display:block; font-family:Arial; font-size:18px; font-weight:bold; line-height:100%; margin-top:0; margin-right:0; margin-bottom:10px; margin-left:0; text-align:left;}h6, .h6{color:#202020; display:block; font-family:Arial; font-size:16px; font-weight:bold; line-height:100%; margin-top:0; margin-right:0; margin-bottom:10px; margin-left:0; text-align:left;}*/ /* h1 a:active, h2 a:active, h3 a:active, h4 a:active, h5 a:active, h6 a:active{color: red !important; Preferably not the same color as the normal header link color. There is limited support for psuedo classes in email clients, this was added just for good measure.}*/ /*h1 a:visited, h2 a:visited, h3 a:visited, h4 a:visited, h5 a:visited, h6 a:visited{color: purple !important; Preferably not the same color as the normal header link color. There is limited support for psuedo classes in email clients, this was added just for good measure.}*/ /* Outlook 07, 10 Padding issue fixBring inline: No.*/ table td{border-collapse: collapse;}/* Styling your links has become much simpler with the new Yahoo. In fact, it falls in line with the main credo of styling in email and make sure to bring your styles inline. Your link colors will be uniform across clients when brought inline.Bring inline: Yes. */ a{color: orange;}.bodyContent img{display: inline; height: auto;}@media only screen and (max-device-width: 480px){/* Part one of controlling phone number linking for mobile. */ a[href^='tel'], a[href^='sms']{text-decoration: none; color: blue; /* or whatever your want */ pointer-events: none; cursor: default;}.mobile_link a[href^='tel'], .mobile_link a[href^='sms']{text-decoration: default; color: orange !important; pointer-events: auto; cursor: default;}}/* More Specific Targeting */ @media only screen and (min-device-width: 768px) and (max-device-width: 1024px){/* You guessed it, ipad (tablets, smaller screens, etc) */ /* repeating for the ipad */ a[href^='tel'], a[href^='sms']{text-decoration: none; color: blue; /* or whatever your want */ pointer-events: none; cursor: default;}.mobile_link a[href^='tel'], .mobile_link a[href^='sms']{text-decoration: default; color: orange !important; pointer-events: auto; cursor: default;}}</style><!--[if IEMobile 7]><style type='text/css'></style><![endif]--><!--[if gte mso 9]><style>/* Target Outlook 2007 and 2010 */</style><![endif]--></head><body height='100%' width='100%' margin='0' padding='0'> <table cellpadding='0' cellspacing='0' border='0' id='backgroundTable' height='100%' width='100%' style='margin: 0; padding: 10px; background-color: #2572EB'> <tr> <td valign='top'> <table cellpadding='0' cellspacing='0' border='0' align='center'> <tr> <td width='602' valign='top' style='text-align:center;' class='browserContent'> <table cellpadding='20' cellspacing='0' width='100%' border='0' align='center'> <tr> <td width='100%' valign='top' style='font-size: 13px; font-family: arial,sans-serif; color: #DDDDDD;'> Este email não está sendo exibido corretamente? <a style='color: #FFFFFF;' href='http://blog.vtnorton.com/sendpress/eyJpZCI6MCwicmVwb3J0Ijo3NzMsInZpZXciOiJ0cmFja2VyIiwidXJsIjoiaHR0cDpcL1wvYmxvZy52dG5vcnRvbi5jb21cL3NlbmRwcmVzc1wvZXlKcFpDSTZOemN6TENKMmFXVjNJam9pWlcxaGFXd2lmUVwvIn0/'>Ver no seu navegador</a>. </td></tr></table> </td></tr></table> <table cellpadding='0' cellspacing='0' border='0' align='center' style='color: #222222;'> <tr> <td width='602' valign='top' class='bodyContent'> <table cellpadding='0' cellspacing='0' width='100%' border='0' align='center' style='font-size: 13px; font-family: arial,sans-serif; background-color: #ffffff; color: #333333;'> <tr> <td width='100%' valign='top' align='center'> <table width='100%' border='0' cellspacing='0' cellpadding='0' id='spnl-ximage-0'> <tr> <td align='center'> <a style='color:#333333' href='http://blog.vtnorton.com/sendpress/eyJpZCI6MCwicmVwb3J0Ijo3NzMsInZpZXciOiJ0cmFja2VyIiwidXJsIjoiaHR0cDpcL1wvdnRub3J0b24uY29tIn0/'><img style='display:block;' src='http://blog.vtnorton.com/wp-content/uploads/2016/07/logo.100.png' border='0' align='center' width='' height='' class='sp-img '></a> </td></tr></table> </td></tr></table> <table cellpadding='10' cellspacing='0' width='100%' border='0' align='left'> <tr> <td width='100%' valign='top' style='font-size: 13px; font-family: arial,sans-serif; color: #222222;'> <table style='margin: 0 -10px;' border='0' width='700' cellspacing='0' cellpadding='0'> <tbody> <tr> <td style='background: #ffffff; padding: 10px 0 20px 0; color: #4d4d4d; font-family: 'Segoe UI',Arial,sans-serif; font-size: 13px; line-height: 20px; border-top: 1px solid #dfdfdf;' align='left' valign='top' width='698'> <div> <table border='0' cellspacing='0' cellpadding='0'> <tbody> <tr> <td style='line-height: 1px;' width='35'></td><td style='font-family: 'Segoe UI',Arial,sans-serif; font-size: 13px; line-height: 20px; padding-bottom: 10px;' align='left' valign='top'> <h1>I've got one feedback for you</h1> </td></tr></tbody> </table> <table border='0' cellspacing='0' cellpadding='0'> <tbody> <tr> <td style='line-height: 1px;' width='35'></td><td style='font-family: 'Segoe UI',Arial,sans-serif; font-size: 13px; line-height: 20px; padding-bottom: 10px;' align='left' valign='top'>";
        private static string End = @"</td><td style='line-height: 1px;' width='20'></td></tr></tbody> </table> </div></td></tr></tbody> </table> <table style='background: #505050; margin: 0 -10px;' border='0' width='700' cellspacing='0' cellpadding='0'> <tbody> <tr> <td style='background: #505050; color: #fffffe; font-family: 'Segoe UI',Arial,sans-serif; font-size: 13px; line-height: 20px; padding: 20px 0;' align='left' valign='top' width='698'> <table style='border-collapse: collapse;' border='0' cellspacing='0' cellpadding='0'> <tbody> <tr> <td style='background: #505050; line-height: 1px;' width='35'></td><td style='background: #505050; color: #fffffe; font-family: 'Segoe UI',Arial,sans-serif; font-size: 13px; line-height: 20px;' align='left' valign='top' width='613'>Eu respeito sua privacidade. Este e-mail foi enviado de uma conta que não é monitorada, caso precise entrar em contato favor enviar um e-mail para contato@vtnorton.com. Você está recebendo esse e-mail por ter entrado na lista de emails do site vtnorton.com</td><td style='background: #505050; line-height: 1px;' width='50'></td></tr></tbody> </table> </td></tr></tbody> </table> <table style='background: #505050; margin: 0 -10px;' border='0' width='700' cellspacing='0' cellpadding='0'> <tbody> <tr> <td style='background: #505050; color: #ffffff; font-family: 'Segoe UI',Arial,sans-serif; font-size: 11px; padding: 24px 0; border-top: solid 1px #898989;' align='left' valign='top' width='698'> <table style='border-collapse: collapse;' border='0' cellspacing='0' cellpadding='0'> <tbody> <tr> <td style='background: #505050; line-height: 1px;' width='35'></td><td style='background: #505050; color: #fffffe; font-family: 'Segoe UI',Arial,sans-serif; font-size: 13px; line-height: 20px;' align='left' valign='top' width='533'>Vitor Norton | Mudando o mundo um bit de cada vez | Cachoeiro de Itapemirim, ES</td><td style='background: #505050; color: #4c4c4c; font-family: 'Segoe UI',Arial,sans-serif; font-size: 11px;' align='left' valign='top' width='20'></td><td style='background: #505050; color: #4c4c4c; font-family: 'Segoe UI',Arial,sans-serif; font-size: 11px;' align='left' valign='top' width='75'></td><td style='background: #505050; line-height: 1px;' width='35'></td></tr></tbody> </table> </td></tr></tbody> </table> </td></tr></table> </td></tr></table> <table cellpadding='0' cellspacing='0' border='0' align='center'> <tr> <td width='602' valign='top' style='text-align:center;' class='footerContent'> <table cellpadding='10' cellspacing='0' width='100%' border='0' align='center'> <tr> <td width='100%' valign='top' style='font-size: 13px; font-family: arial,sans-serif; color: #DDDDDD;'> </td></tr><tr> <td width='100%' valign='top' style='font-size: 13px; font-family: arial,sans-serif; color: #DDDDDD;'> <p style=' margin-top:0;margin-bottom:10px;'>Copyright © 2016 Vítor Norton, todos os direitos reservados.<br>Você está recebendo esse e-mail porque você está como destinatário no programa de Feedback</p></td></tr></table> </td></tr></table> </td></tr></table> <img src='http://blog.vtnorton.com/sendpress/eyJpZCI6MCwicmVwb3J0Ijo3NzMsInZpZXciOiJvcGVuIn0/?img=773-57e5228c56da0' width='1' height='1' alt='' border='0' style='height:1px !important; width:1px !important; border-width:0 !important; margin-top:0 !important; margin-bottom:0 !important; margin-right:0 !important; margin-left:0 !important; padding-top:0 !important; padding-bottom:0 !important; padding-right:0 !important; padding-left:0 !important;'/></body></html>";
        [WebMethod]
        public void SendFeedbackEmail(string xProject, string xMenssage, string xMail, string xSubject)
        {
            MailAddress replyTo = new MailAddress(xMail);
            SmtpClient Client = new SmtpClient();
            MailMessage Message = new MailMessage();
            Client.Host = "smtp.gmail.com";
            Client.Port = 587;
            Client.UseDefaultCredentials = false;
            Client.Credentials = new NetworkCredential("jade@vtnorton.com", "");
            Client.EnableSsl = true;
            Message.IsBodyHtml = true;
            Message.Subject = "[" + xProject + " feedback]: " + xSubject;
            Message.Body = string.Concat(Start + "Who send the feedback: " + xMail + " <br/>This is the feedback sent by Project " + xProject + ": <br/>" + xMenssage + End);
            Message.ReplyToList.Add(new MailAddress(xMail));
            Message.From = new MailAddress("contato@vtnorton.com", "Vitor Norton");
            Message.To.Add(new MailAddress("contato@vtnorton.com", "Vitor Norton"));
            Client.Send(Message);
        }
    }
}
